# Services-Not-Signed---Generic
Demonstrates automation using Credible Web Services
Instructions
  1. Start by creating a webservice report in Credible
  2. Add the contents from "Services Not Signed.sql" to the report and create 3 parameters:
    a. Start Date
    b. End Date
    c. Visits(optional)
  3. Feel free to change what you wish but you will most likely want to focus on
     "CVT.program_id Not In (74)" and "BillingMatrix.cpt_4_code Not In  ('', '99999', 'nobill','none')"
     This allows you to omit specific programs and non-billing CPT codes.
  4. Visual Studio - This application was built using C# but feel free to port it any language.
     The email is the exact email we use to send to employees. It was developed by a billing
     employee. You will need to change some code in order to test this application.
     a. Line 23 - SmtpClient("mailserver.yourdomain.com") change this to a relevant server
        i. You may need to address more mail server issues not covered in this tutorial
     b. Line 65 - "youremailaddress@yourdomain.com" change to your email. This line catches
        employees with no email address and will attempt to send to supervisor email. If that
        is also blank you will receive the email.
     c. Line 69 - "no-reply@yourdomain.com" change this to whatever return address you wish.
     d. Line 78 - "youremailaddress@yourdomain.com" change this to your email address.
        You can actually comment this out during testing. This line simply sends a blind courtesy
        copy to whoever wishes to monitor the emails. I send it to myself and use mail rules
        to route it to a specified folder.
     e. Line 177 - "connection_string" change this to the string generated by Credible when the WS report
        was created.
     f. Line 231 - copy and hardcode email addresses during testing phase
         i.  string result = sendEmail(emailaddress, supervisoremail, CC, "Services not signed in 24 hours", reader.Value.Trim(), emp_id);
         ii. emailaddress should be your email address and supervisoremail can be another tester's email address if you desire
             after the testing phase, delete your copy and uncomment the above code.
   5. How to automate. I run this scheduled task Mon-Fri at 9:05 am and 4:05 pm. I also run a 3:05pm task for E&M visits daily for
      same day visits.
      a. Create a scheduled task(at least 2)
        i.  Monday - This scheduled task runs on Monday at 9:05 am and 4:05 pm. It pulls data from Friday and over the weekend.
            Triggers - Weekly - 9:05 am, Weekly - 4:05 pm
            Actions - Start a program; 
                      Program/script: "C:\HorizonBH\ServicesNotSigned\Services Not Signed.exe"
                      Add a arguments(optional): -3
        ii. Tue-Fri - This scheduled task runs on Tue-Fri at 9:05 am and 4:05 pm. It pulls data from the previous day.
            Triggers - Weekly - 9:05 am every Tuesday, Wednesday, Thursday, Friday of every week 
                       Weekly - 4:05 pm every Tuesday, Wednesday, Thursday, Friday of every week 
            Actions - Start a program; 
                      Program/script: "C:\HorizonBH\ServicesNotSigned\Services Not Signed.exe"
                      No arguments    
        iii.Tue-Fri - This scheduled task runs on Mon-Fri at 3:05 pm. It pulls data for the same day for E&M visits.
                      It also CC's additional employees.
            Triggers - Weekly - 3:05 pm every Monday, Tuesday, Wednesday, Thursday, Friday of every week 
            Actions - Start a program; 
                      Program/script: "C:\HorizonBH\ServicesNotSigned\Services Not Signed.exe"
                      Add a arguments(optional): 0 CC:email@domain.org;email@domain.org;email@domain.org;email@domain.org Visittype:E&M%
                      
                      The application reads the arguments from left to right start_date/previous_days, end_date/previous_days,
                      email_address, visittype. For multiple email address only one "CC:" is needed. The email addresses can then be 
                      seperated by commas or semicolons. There can only be one visittpe at a time due to SQL constraints. You can modify
                      the SQL or schedule seperate tasks if you wish to only send based on specific visittypes only. The current SQL uses
                      a Like operator for visittype so yo can pass in %E&M% or something similar or change it all together! :)
                      
Hopefully this helps someone. Enjoy!
